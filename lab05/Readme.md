## Лабораторная работа. Настройка OSPFv2 для нескольких областей ##

![](https://github.com/svasornd/otus_network/blob/master/lab05/lab_05.png)

| Устройство  | Интерфейс   | IP адрес  | Маска подсети |
| ---------- | ------------| ----------| ------------ | 
|  R1 | Lo0 | 209.165.200.225 | 255.255.255.252 |
|  R1 | Lo1 | 192.168.1.1 | 255.255.255.0 | 
|  R1 | Lo2 | 192.168.2.1 | 255.255.255.0 | 
|  R1 | S1/0 (DCE) | 192.168.12.1 | 255.255.255.252 | 
|  R2 | Lo6 | 192.168.6.1 | 255.255.255.0 |
|  R2 | s1/0 | 192.168.12.2 | 255.255.255.252 |
|  R2 | s1/1(DCE) | 192.168.23.1 | 255.255.255.252 | 
|  R3 | Lo4  | 192.168.4.1 | 255.255.255.0 |
|  R3 | Lo5  | 192.168.5.1 | 255.255.255.0 |
|  R3 | s1/1  | 192.168.23.2 | 255.255.255.252 |

[Конфигурация R1](https://github.com/svasornd/otus_network/blob/master/lab05/config/R1.md)

[Конфигурация R2](https://github.com/svasornd/otus_network/blob/master/lab05/config/R2.md) 

[Конфигурация R3](https://github.com/svasornd/otus_network/blob/master/lab05/config/R3.md)

#####  Определите магистральные маршрутизаторы: #####  

R2 R1 области AREA 0

#####  Определите граничные маршрутизаторы автономной системы (ASBR): #####  

R1 

 ##### Определите граничные маршрутизаторы области (ABR):  ##### 

R2 в областях AREA 0 и  AREA 2

R1 в областях AREA 0 и  AREA 1

 ##### Определите внутренние маршрутизаторы: ##### 

R3 в области AREA 3


 ##### Настройте идентификатор маршрутизатора 2.2.2.2 с идентификатором процесса OSPF 1. Добавьте OSPF для сетей маршрутизатора R2. Добавьте сети в соответствующую область. Запишите использованные команды в поле ниже.  ##### 

*router ospf 1*

*router-id 2.2.2.2*

*network 192.168.6.0 0.0.0.255 area 3*

*network 192.168.12.0 0.0.0.3 area 0*

*network 192.168.23.0 0.0.0.3 area 3*

*passive-interface loopback 6*


 ##### Настройте идентификатор маршрутизатора 3.3.3.3 с идентификатором процесса OSPF 1.
Добавьте OSPF для сетей маршрутизатора R3. Запишите использованные команды в поле ниже. ##### 

*router ospf 1*

*router-id 3.3.3.3*

*network 192.168.4.0 0.0.0.255 area 3*

*network 192.168.5.0 0.0.0.255 area 3*

*network 192.168.23.0 0.0.0.3 area 3*

*passive-interface loopback 4*

*passive-interface loopback 5*


 ##### К какому типу маршрутизаторов OSPF относится каждый маршрутизатор? ##### 

R1: граничный маршрутизатор области (area border router) и граничный маршрутизатор автономной системы (autonomous system boundary router)

R2: граничный маршрутизатор области (area border router)

R3: внутренниий маршрутизатор

 ##### Почему перед настройкой аутентификации OSPF полезно проверить правильность работы OSPF? ##### 

Чтобы проверить сходимость и после включение аутентификации, при проверке сходимости быть увереннм что схма построена и настроена верно.

 ##### Повторите команду show ip route ospf для R2 и R3. Запишите маршруты OSPF между областями для каждого маршрутизатора. ##### 

R2:

    O*E2  0.0.0.0/0 [110/1] via 192.168.12.1, 20:42:10, Serial1/0
          192.168.1.0/32 is subnetted, 1 subnets
    O IA     192.168.1.1 [110/65] via 192.168.12.1, 20:42:10, Serial1/0
          192.168.2.0/32 is subnetted, 1 subnets
    O IA     192.168.2.1 [110/65] via 192.168.12.1, 20:42:10, Serial1/0
          192.168.4.0/32 is subnetted, 1 subnets
    O        192.168.4.1 [110/65] via 192.168.23.2, 20:39:55, Serial1/1
          192.168.5.0/32 is subnetted, 1 subnets
    O        192.168.5.1 [110/65] via 192.168.23.2, 20:39:55, Serial1/1


R3:

    O*E2  0.0.0.0/0 [110/1] via 192.168.23.1, 20:40:05, Serial1/1
          192.168.1.0/32 is subnetted, 1 subnets
    O IA     192.168.1.1 [110/129] via 192.168.23.1, 20:40:05, Serial1/1
          192.168.2.0/32 is subnetted, 1 subnets
    O IA     192.168.2.1 [110/129] via 192.168.23.1, 20:40:05, Serial1/1
          192.168.6.0/32 is subnetted, 1 subnets
    O        192.168.6.1 [110/65] via 192.168.23.1, 20:40:05, Serial1/1
          192.168.12.0/30 is subnetted, 1 subnets
    O IA     192.168.12.0 [110/128] via 192.168.23.1, 20:40:05, Serial1/1



 ##### Повторите команду show ip ospf database для R2 и R3. Запишите идентификаторы каналов (Link ID) для состояний суммарных сетевых каналов (Summary Net Link State) каждой области. ##### 

R2:

    Summary Net Link States (Area 0)

    Link ID         ADV Router      Age         Seq#       Checksum
    192.168.1.1     1.1.1.1         878         0x8000002B 0x005A48
    192.168.2.1     1.1.1.1         878         0x8000002B 0x004F52
    192.168.4.1     2.2.2.2         1228        0x80000027 0x00A5B9
    192.168.5.1     2.2.2.2         1228        0x80000027 0x009AC3
    192.168.6.1     2.2.2.2         1228        0x80000029 0x000992
    192.168.23.0    2.2.2.2         1228        0x80000029 0x00BD91

    Summary Net Link States (Area 3)

    Link ID         ADV Router      Age         Seq#       Checksum
    192.168.1.1     2.2.2.2         1228        0x80000027 0x00C69B
    192.168.2.1     2.2.2.2         1228        0x80000027 0x00BBA5
    192.168.12.0    2.2.2.2         1228        0x80000029 0x003723


R3:

   Summary Net Link States (Area 3)

    Link ID         ADV Router      Age         Seq#       Checksum
    192.168.1.1     2.2.2.2         1235        0x80000027 0x00C69B
    192.168.2.1     2.2.2.2         1235        0x80000027 0x00BBA5
    192.168.12.0    2.2.2.2         1235        0x80000029 0x003723


 ##### Рассчитайте суммарный маршрут для сетей в области 3. Запишите результаты. ##### 

192.168.4.0 255.255.254.0 или 192.168.4.0/23

 ##### Настройте суммарный маршрут для области 3 на маршрутизаторе R2. Запишите использованные команды в отведённой ниже области. ##### 

*router ospf 1*

*area 3 range 192.168.4.0 255.255.254.0*


##### Отобразите таблицы маршрутизации OSPF для всех маршрутизаторов.
Выполните команду show ip route ospf на каждом маршрутизаторе. Запишите результаты для суммарных и межобластных маршрутов. ##### 

R1:

    O     192.168.0.0/22 is a summary, 00:10:25, Null0
    O IA  192.168.4.0/23 [110/129] via 192.168.12.2, 00:02:53, Serial1/0
          192.168.6.0/32 is subnetted, 1 subnets
    O IA     192.168.6.1 [110/65] via 192.168.12.2, 00:10:25, Serial1/0
          192.168.23.0/30 is subnetted, 1 subnets
    O IA     192.168.23.0 [110/128] via 192.168.12.2, 00:10:25, Serial1/0

R2:

    O*E2  0.0.0.0/0 [110/1] via 192.168.12.1, 00:02:08, Serial1/0
    O IA  192.168.0.0/22 [110/65] via 192.168.12.1, 00:02:08, Serial1/0
    O     192.168.4.0/23 is a summary, 00:02:08, Null0
          192.168.4.0/32 is subnetted, 1 subnets
    O        192.168.4.1 [110/65] via 192.168.23.2, 00:02:08, Serial1/1
          192.168.5.0/32 is subnetted, 1 subnets
    O        192.168.5.1 [110/65] via 192.168.23.2, 00:02:08, Serial1/1

R3:

    O*E2  0.0.0.0/0 [110/1] via 192.168.23.1, 21:49:08, Serial1/1
    O IA  192.168.0.0/22 [110/129] via 192.168.23.1, 00:10:04, Serial1/1
        192.168.6.0/32 is subnetted, 1 subnets
    O        192.168.6.1 [110/65] via 192.168.23.1, 21:49:08, Serial1/1
        192.168.12.0/30 is subnetted, 1 subnets
    O IA     192.168.12.0 [110/128] via 192.168.23.1, 21:49:08, Serial1/1

 ##### Шаг 5:	Просмотрите базы данных LSDB на всех маршрутизаторах.
Выполните команду show ip route database на каждом маршрутизаторе. Запишите идентификаторы каналов (Link ID) для состояний суммарных сетевых каналов (Summary Net Link State) каждой области. ##### 

R1:
                Summary Net Link States (Area 0)

    Link ID         ADV Router      Age         Seq#       Checksum
    192.168.0.0     1.1.1.1         1164        0x80000001 0x00B41D
    192.168.4.0     2.2.2.2         712         0x80000001 0x00F690
    192.168.6.1     2.2.2.2         898         0x8000002A 0x000793
    192.168.23.0    2.2.2.2         898         0x8000002A 0x00BB92


                Summary Net Link States (Area 1)

    Link ID         ADV Router      Age         Seq#       Checksum
    192.168.4.0     1.1.1.1         711         0x80000001 0x0097B3
    192.168.6.1     1.1.1.1         531         0x80000028 0x00ABB4
    192.168.12.0    1.1.1.1         531         0x8000002A 0x00530A
    192.168.23.0    1.1.1.1         531         0x80000028 0x0060B3


R2:


                Summary Net Link States (Area 0)

    Link ID         ADV Router      Age         Seq#       Checksum
    192.168.0.0     1.1.1.1         1302        0x80000001 0x00B41D
    192.168.4.0     2.2.2.2         848         0x80000001 0x00F690
    192.168.6.1     2.2.2.2         1034        0x8000002A 0x000793
    192.168.23.0    2.2.2.2         1034        0x8000002A 0x00BB92

                Summary Net Link States (Area 3)

    Link ID         ADV Router      Age         Seq#       Checksum
    192.168.0.0     2.2.2.2         1301        0x80000001 0x001974
    192.168.12.0    2.2.2.2         1034        0x8000002A 0x003524

R3:

                Summary Net Link States (Area 3)

    Link ID         ADV Router      Age         Seq#       Checksum
    192.168.0.0     2.2.2.2         1350        0x80000001 0x001974
    192.168.12.0    2.2.2.2         1083        0x8000002A 0x003524


#####  Пакет LSA какого типа передается в магистраль маршрутизатором ABR, когда включено объединение межобластных маршрутов? #####  

Сообщения LSA третьего типа

 ##### Какие три преимущества при проектировании сети предоставляет OSPF для нескольких областей? ##### 

  Таблицы маршрутизации меньшего размера меньшее число записей в таблицах маршрутизации, поскольку сетевые адреса могут объединяться между областями.

  Сокращение накладных расходов на обновление состояний каналов.

  Уменьшение частоты расчётов SPF.
