
# EIGRP для IPv4 #

Содержание

[Лабораторная работа. Базовая настройка протокола EIGRP для IPv4](#part1)

[Лабораторная работа. Настройка расширенных функций EIGRP для IPv4](#part2)




## <a name="part1">  Лабораторная работа. Базовая настройка протокола EIGRP для IPv4 </a>  ##

![](https://github.com/svasornd/otus_network/blob/master/lab06/Lab06.png)

| Устройство | Интерфейс | IP адрес | Маска подсети | Шлюз по умолчанию |
| ---------- | ------------| ----------| ------------ | ------------ | 
|  R1 | e0/0 | 192.168.1.1 | 255.255.255.0 | - |
|  R1 | s1/0 (DCE) | 10.1.1.1 | 255.255.255.252 | - |
|  R1 | s1/2 | 10.3.3.1 | 255.255.255.252 | - |
|  R2 | e0/0 | 192.168.2.1 | 255.255.255.0 | - |
|  R2 | s1/0 | 10.1.1.2 | 255.255.255.252 | - |
|  R2 | s1/1 (DCE) | 10.2.2.2| 255.255.255.252 | - |
|  R3 | e0/0  | 192.168.3.1 | 255.255.255.0 | - |
|  R3 | s1/2 (DCE) | 10.3.3.2| 255.255.255.252 | - |
|  R3 | s1/1  | 10.2.2.1| 255.255.255.252 | - |
|  PC-A | NIC  | 192.168.1.3 | 255.255.255.0 | 192.168.1.1 |
|  PC-A | NIC  | 192.168.2.3 | 255.255.255.0 | 192.168.2.1 |
|  PC-A | NIC  | 192.168.3.3 | 255.255.255.0 | 192.168.3.1 |

[Конфигурация R1](https://github.com/svasornd/otus_network/blob/master/lab06/config/R1.md)

[Конфигурация R2](https://github.com/svasornd/otus_network/blob/master/lab06/config/R2.md) 

[Конфигурация R3](https://github.com/svasornd/otus_network/blob/master/lab06/config/R3.md)


#####  Почему рекомендуется использовать шаблонные маски при объявлении сетей? Можно ли исключить маску в какой-нибудь из вышеприведённых инструкций network? Если да, то в какой (в каких)? #####  

Чтобы использовать только адреса с интерфесов попадающие в это диапазон и не анонсировать классовые сети. Можно исключить 

*network 192.168.1.0 0.0.0.255*

При команде 

*network 192.168.1.0*

будет использованна сеть класса C  с маской /24, т.е. полностью совпадающая с шаблонной маской.

#####  Почему у маршрутизатора R1 два пути к сети 10.2.2.0/30? #####  

Ему приходят 2 маршрута к сети 10.2.2.0/30.  Один через интерфейс Serial1/2, второй через Serial1/0 с равной суммарной метрикой.

        D        10.2.2.0/30 [90/2681856] via 10.3.3.2, 00:03:06, Serial1/2
                             [90/2681856] via 10.1.1.2, 00:03:06, Serial1/0

#####  Почему в таблице топологии маршрутизатора R1 отсутствуют возможные преемники? #####  

Каждый маршрут до пути назначения имеет одинаковую суммарную метрику и поэтому оба маршрутизатора R2 и R3 являются заместителями. 

#####  Какой номер автономной системы используется?  #####  

        EIGRP-IPv4 Protocol for AS(10)

#####  Какие сети объявляются? #####  

        Routing for Networks:
            10.1.1.0/30
            10.3.3.0/30
            192.168.1.0

#####  Каково значение административной дистанции для маршрутов EIGRP?  #####  

Для внутренних 90 - внешних 170

          Distance: internal 90 external 170


#####  Сколько маршрутов с равной стоимостью по умолчанию использует EIGRP? #####  


         Maximum path: 4

#####  Какова пропускная способность по умолчанию для этого последовательного интерфейса?  #####  

BW 1544 Kbit/sec

        Serial1/0 is up, line protocol is up
          Hardware is M4T
          Internet address is 10.1.1.1/30
          MTU 1500 bytes, BW 1544 Kbit/sec, DLY 20000 usec,
             reliability 255/255, txload 1/255, rxload 1/255
          Encapsulation HDLC, crc 16, loopback not set
          Keepalive set (10 sec)
          Restart-Delay is 0 secs
          Last input 00:00:01, output 00:00:02, output hang never
          Last clearing of "show interface" counters 06:10:36
          Input queue: 0/75/0/0 (size/max/drops/flushes); Total output drops: 0
          Queueing strategy: fifo
          Output queue: 0/40 (size/max)
          5 minute input rate 0 bits/sec, 0 packets/sec
          5 minute output rate 0 bits/sec, 0 packets/sec
             2915 packets input, 212759 bytes, 0 no buffer
             Received 2573 broadcasts (0 IP multicasts)
             0 runts, 0 giants, 0 throttles
             0 input errors, 0 CRC, 0 frame, 0 overrun, 0 ignored, 0 abort
             3029 packets output, 219850 bytes, 0 underruns
             0 output errors, 0 collisions, 3 interface resets
             0 unknown protocol drops
             0 output buffer failures, 0 output buffers swapped out
             3 carrier transitions     DCD=up  DSR=up  DTR=up  RTS=up  CTS=up


#####   Сколько маршрутов к сети 10.2.2.0/30 содержит таблица маршрутизации? #####  

Два маршрута

        D        10.2.2.0/30 [90/2681856] via 10.3.3.2, 00:25:45, Serial1/2
                             [90/2681856] via 10.1.1.2, 00:25:45, Serial1/0

#####  Выполните на маршрутизаторе R1 команду show ip route. Появились ли изменения в таблице маршрутизации? Если да, в чем они заключаются? #####  

До сети 10.2.2.0/30 остался толкьо 1 действующий маршрут

        10.2.2.0/30 [90/2681856] via 10.1.1.2, 00:00:14, Serial1/0

#####  Исходя из заданной пропускной способности, попробуйте определить, как будут выглядеть таблицы маршрутизации маршрутизаторов R2 и R3 до выполнения команды show ip route. Останутся ли их таблицы маршрутизации прежними или изменятся? #####  

Для R2 таблица маршрутизации не измениится.

Для R3 все марштуруты будут через R2 , так их стоимость будт наименьшей. 

#####  При выполнении лабораторной работы можно было ограничиться только статической маршрутизацией. Каковы преимущества использования EIGRP? #####  

Легко задать маршрут прохождения трафика, при использовании статической маршрутизации на каждом роутере надо было прописать 6 маршрутов на каждом роутере. И в ручную указать метрику для выбора необходимого маршрута. 
Так же более просто в добавлении еше одной сети. Если надо её добавить, достаточно добавить только на одном маршрутизаторе и он сообщит остальным.

## <a name="part2"> Лабораторная работа. Настройка расширенных функций EIGRP для IPv4 ## </a> ## 

![](https://github.com/svasornd/otus_network/blob/master/lab06/Lab06_01.png)

| Устройство | Интерфейс | IP адрес | Маска подсети | Шлюз по умолчанию |
| ---------- | ------------| ----------| ------------ | ------------ | 
|  R1 | e0/0 | 192.168.1.1 | 255.255.255.0 | - |
|  R1 | s1/0 (DCE) | 192.168.12.1| 255.255.255.252 | - |
|  R1 | s1/2 | 192.168.13.1 | 255.255.255.252 | - |
|  R1 | Lo1 | 192.168.11.1 | 255.255.255.252 | - |
|  R1 | Lo5 | 192.168.11.5 | 255.255.255.252 | - |
|  R1 | Lo9 | 192.168.11.9 | 255.255.255.252 | - |
|  R1 | Lo13 | 192.168.11.13 | 255.255.255.252 | - |
|  R2 | e0/0 | 192.168.2.1 | 255.255.255.0 | - |
|  R2 | s1/0 | 192.168.12.2 | 255.255.255.252 | - |
|  R2 | s1/1 (DCE) | 192.168.23.21 | 255.255.255.252 | - |
|  R2 | Lo1 | 192.168.22.1 | 255.255.255.252 | - |
|  R3 | e0/0  | 192.168.3.1 | 255.255.255.0 | - |
|  R3 | s1/2 (DCE) | 192.168.13.2 | 255.255.255.252 | - |
|  R3 | s1/1  | 192.168.23.2 | 255.255.255.252 | - |
|  R3 | Lo1 | 192.168.33.1 | 255.255.255.252 | - |
|  R3 | Lo5 | 192.168.33.5 | 255.255.255.252 | - |
|  R3 | Lo9 | 192.168.33.9 | 255.255.255.252 | - |
|  R3 | Lo13 | 192.168.33.13 | 255.255.255.252 | - |
|  PC-A | NIC  | 192.168.1.3 | 255.255.255.0 | 192.168.1.1 |
|  PC-A | NIC  | 192.168.2.3 | 255.255.255.0 | 192.168.2.1 |
|  PC-A | NIC  | 192.168.3.3 | 255.255.255.0 | 192.168.3.1 |

[Конфигурация R1](https://github.com/svasornd/otus_network/blob/master/lab06/config/R1_01.md)

[Конфигурация R2](https://github.com/svasornd/otus_network/blob/master/lab06/config/R2_01.md) 

[Конфигурация R3](https://github.com/svasornd/otus_network/blob/master/lab06/config/R3_01.md)

#####  На маршрутизаторе R1 настройте маршрутизацию EIGRP с номером автономной системы (AS) 1 для всех сетей с прямым подключением. Запишите использованные команды в поле ниже. #####  

*router eigrp 1*

*network 192.168.1.0 0.0.0.255*

*network 192.168.13.0 0.0.0.3*

*network 192.168.12.0 0.0.0.3*

#####  Для интерфейса локальной сети маршрутизатора R1 отключите передачу пакетов приветствия (hello) EIGRP. Ниже напишите команду, которую вы использовали. #####  

*passive-interface ethernet 0/0*

#####  На маршрутизаторе R1 настройте пропускную способность для интерфейса S0/0/0 равной 1024 Кбит/с, а для интерфейса S0/0/1 равной 64 Кбит/с. Запишите использованные команды в поле ниже. Примечание. Команда bandwidth влияет только на вычисление показателя EIGRP, а не на фактическую пропускную способность последовательного канала связи. #####  

*interface s1/0*

*bandwidth 1024*

*interface s1/2*

*bandwidth 64*

#####  Введите команду show ip protocols на R1. Как по умолчанию настроено автоматическое объединение в EIGRP? #####  

Автоматическое объединение отключено

                 Automatic Summarization: disabled

#####  Добавьте соответствующие инструкции network для процесса EIGRP на маршрутизаторе R1.  #####  

Первый вариант 

*network 192.168.11.0 0.0.0.3*

*network 192.168.11.4 0.0.0.3*

*network 192.168.11.8 0.0.0.3*

*network 192.168.11.11 0.0.0.3*

Второй вариант

*network 192.168.11.0 0.0.0.15*

#####  На маршрутизаторе R2 выполните команду show ip route eigrp. Как сети loopback представлены в результатах этой команды? #####  

                      192.168.11.0/30 is subnetted, 4 subnets
                D        192.168.11.0 [90/3139840] via 192.168.12.1, 00:16:12, Serial1/0
                D        192.168.11.4 [90/3139840] via 192.168.12.1, 00:14:46, Serial1/0
                D        192.168.11.8 [90/3139840] via 192.168.12.1, 00:00:05, Serial1/0
                D        192.168.11.12 [90/3139840] via 192.168.12.1, 00:09:11, Serial1/0


#####  На маршрутизаторе R1 выполните команду auto-summary в рамках процесса EIGRP. Как изменилась таблица маршрутизации на R2? #####  

                      192.168.11.0/24 is subnetted, 1 subnets
                D        192.168.11.0 [90/3139840] via 192.168.12.1, 00:00:12, Serial1/0


#####  Повторите подшаги б–д, добавив интерфейсы обратной петли, сети процесса EIGRP и автоматическое объединение на маршрутизаторе R3. #####  

*network 192.168.33.0 0.0.0.3*

*network 192.168.33.4 0.0.0.3*

*network 192.168.33.8 0.0.0.3*

*network 192.168.33.12 0.0.0.3*

                      192.168.33.0/30 is subnetted, 4 subnets
                D        192.168.33.0 [90/2297856] via 192.168.23.2, 00:02:11, Serial1/1
                D        192.168.33.4 [90/2297856] via 192.168.23.2, 00:01:52, Serial1/1
                D        192.168.33.8 [90/2297856] via 192.168.23.2, 00:01:40, Serial1/1
                D        192.168.33.12 [90/2297856] via 192.168.23.2, 00:01:30, Serial1/1

                      192.168.33.0/24 is subnetted, 1 subnets
                D        192.168.33.0 [90/2297856] via 192.168.23.2, 00:00:04, Serial1/1


#####  На маршрутизаторе R1 выполните команду show ip route eigrp | include 0.0.0.0, чтобы просмотреть инструкции, относящиеся к маршруту по умолчанию. Как статический маршрут по умолчанию представлен в результатах этой команды? Укажите административную дистанцию (AD) распространяемого маршрута. #####  

Административная дистанция имеет значени по умолчанию для внешних маршрутов 170

                Gateway of last resort is 192.168.12.2 to network 0.0.0.0
                D*EX  0.0.0.0/0 [170/3139840] via 192.168.12.2, 00:02:06, Serial1/0

#####  На маршрутизаторе R2 используйте команду show ip eigrp interfaces detail для просмотра интервала приветствия и таймера задержки для EIGRP. #####  

Укажите значение таймера приветствия по умолчанию. 

Укажите значение таймера удержания по умолчанию. 

                Se1/0
                Hello-interval is 5, Hold-time is 15
                Se1/1 
                Hello-interval is 5, Hold-time is 15


#####  Вопросы для повторения #####  
#####  1.	В чем заключаются преимущества объединения маршрутов? #####  

- Уменьшает количество передаваемого трафика
- Уменьшает количество маршрутов и делает таблицу маршрутизации более читаемой, особенно в большой сети

#####  2.	Почему при настройке таймеров EIGRP необходимо настраивать значение времени удержания равным или больше интервала приветствия? #####  

Чтобы соседи успевали установить соседство и сообщить о своей активности, до того как закончится время удержания. И не происходило потеря соседства.


