## Лабораторная работа. Настройка базового протокола OSPFv2 для одной области ##

![](https://github.com/svasornd/otus_network/blob/master/lab04/lab_04.png)

| Устройство  | Интерфейс   | IP адрес  | Маска подсети | Шлюз по умолчанию |
| ---------- | ------------| ----------| ------------ | ------------ |
|  R1 | e0/0 | 192.168.1.1 | 255.255.255.0 | - |
|  R1 | s1/0 | 192.168.12.1 | 255.255.255.252 | - |
|  R1 | s1/2 | 192.168.13.1 | 255.255.255.252 | - |
|  R1 | Lo1  | 1.1.1.1 | 255.255.255.255 | - |
|  R2 | e0/0 | 192.168.2.1 | 255.255.255.0 | - |
|  R2 | s1/0 | 192.168.12.2 | 255.255.255.252 | - |
|  R2 | s1/1 | 192.168.23.1 | 255.255.255.252 | - |
|  R2 | Lo1  | 2.2.2.2 | 255.255.255.255 | - |
|  R3 | e0/0  | 192.168.3.1 | 255.255.255.0 | - |
|  R3 | s1/1  | 192.168.13.2 | 255.255.255.252 | - |
|  R3 | s1/2  | 192.168.23.2 | 255.255.255.252 | - |
|  R3 | Lo1  | 3.3.3.3 | 255.255.255.255 | - |
|  S1 | VLAN 1  | 192.168.1.11 | 255.255.255.0 | 192.168.1.1 |
|  S2 | VLAN 1  | 192.168.1.13 | 255.255.255.0 | 192.168.1.3 |
|  PC-A | NIC  | 192.168.1.3 | 255.255.255.0 | 192.168.1.1 |
|  PC-B | NIC  | 192.168.2.3 | 255.255.255.0 | 192.168.2.1 |
|  PC-C | NIC  | 192.168.3.3 | 255.255.255.0 | 192.168.3.1 |


[Конфигурация R1](https://github.com/svasornd/otus_network/blob/master/lab04/config/R1.md)

[Конфигурация R2](https://github.com/svasornd/otus_network/blob/master/lab04/config/R2.md) 

[Конфигурация R3](https://github.com/svasornd/otus_network/blob/master/lab04/config/R3.md)


#####  Какую команду вы бы применили, чтобы просмотреть в таблице маршрутизации только маршруты OSPF? #####  

*show ip route ospf*

#####  Какой интерфейс использует R3 для маршрута к сети 192.168.2.0/24? #####  

Serial1/2

	192.168.2.0/24 [110/138] via 192.168.13.1, 00:01:15, Serial1/2

#####  Чему равна суммарная метрика стоимости для сети 192.168.2.0/24 на R3? #####  

138

	192.168.2.0/24 [110/138] via 192.168.13.1, 00:01:15, Serial1/2

#####  Отображается ли маршрутизатор R2 как соседнее устройство OSPF на маршрутизаторе R1? #####  

Да, отображется.

	Neighbor ID     Pri   State           Dead Time   Address         Interface
	33.33.33.33       0   FULL/  -        00:00:34    192.168.13.2    Serial1/2
	22.22.22.22       0   FULL/  -        00:00:30    192.168.12.2    Serial1/0

#####  Отображается ли маршрутизатор R2 как соседнее устройство OSPF на маршрутизаторе R3? #####  

Нет, не отображется

	Neighbor ID     Pri   State           Dead Time   Address         Interface
	11.11.11.11       0   FULL/  -        00:00:38    192.168.13.1    Serial1/2

Что дает вам эта информация?




#####  Настройте интерфейс S0/0/1 маршрутизатора R2 так, чтобы разрешить ему объявлять маршруты OSPF. Ниже запишите используемые команды. #####  

*router ospf 1*
*no passive-interface serial 1/1*

#####  Какой интерфейс использует R3 для маршрута к сети 192.168.2.0/24? #####  

Serial1/1

	192.168.2.0/24 [110/74] via 192.168.23.1, 00:00:04, Serial1/1

#####  Чему равна суммарная метрика стоимости для сети 192.168.2.0/24 на маршрутизаторе R3? Как она была рассчитана? #####  

74 = 64(стоимость канала R2-R3) + 10 (стоимость канала R2 e0/0 )

	192.168.2.0/24 [110/74] via 192.168.23.1, 00:00:04, Serial1/1

#####  Отображается ли маршрутизатор R2 как сосед OSPF для маршрутизатора R3? #####  

Отображается

	Neighbor ID     Pri   State           Dead Time   Address         Interface
	11.11.11.11       0   FULL/  -        00:00:35    192.168.13.1    Serial1/2
	22.22.22.22       0   FULL/  -        00:00:35    192.168.23.1    Serial1/1


#####  Объясните, как были рассчитаны стоимости маршрутов от маршрутизатора R1 для сетей 192.168.3.0/24 и 192.168.23.0/30. #####  

Для сети 192.168.3.0/24 791 = 781 (стоимость канала R1-R3) + 10 (стоимость канала R3 e0/0 )

Для сети 192.168.23.0/30 845 = 781 (стоимость канала R1-R3) + 64 (стоимость канала R3-R2) 

Для сети 192.168.23.0/30 845 = 781 (стоимость канала R1-R2) + 64 (стоимость канала R2-R3) 

	O       192.168.2.0/24 [110/791] via 192.168.12.2, 00:00:13, Serial1/0
	O       192.168.3.0/24 [110/791] via 192.168.13.2, 00:00:13, Serial1/2
		192.168.23.0/30 is subnetted, 1 subnets
	O       192.168.23.0 [110/845] via 192.168.13.2, 00:00:13, Serial1/2
			     [110/845] via 192.168.12.2, 00:00:13, Serial1/0

#####  Чему равна новая суммарная стоимость для сети 192.168.23.0/24 на R1? Почему? #####  

Для сети 192.168.23.0/30 1562 = 781 (стоимость канала R1-R2) + 781 (стоимость канала R2-R3) 

	O     192.168.2.0/24 [110/791] via 192.168.12.2, 00:06:04, Serial1/0
	O     192.168.3.0/24 [110/791] via 192.168.13.2, 00:06:04, Serial1/2
	      192.168.23.0/30 is subnetted, 1 subnets
	O     192.168.23.0 [110/1562] via 192.168.13.2, 00:00:25, Serial1/2
                           [110/1562] via 192.168.12.2, 00:00:25, Serial1/0


#####  Почему маршрут к сети 192.168.3.0/24 от маршрутизатора R1 теперь проходит через R2? #####  

Стоимость маршурта канала через R3 была изменена и стала, больше. 
Стоимость через R2 781(R1-R2) + 781 (R2-R3) + 10 (R3 e0/0) = 1572
Стоимость через R3 1565(R1-R3) + 10 (R3 e0/0) = 1575

*sh ip ospf interface brief*
	Interface    PID   Area            IP Address/Mask    Cost  State Nbrs F/C
	Se1/2        1     0               192.168.13.1/30    1565  P2P   0/0
	Se1/0        1     0               192.168.12.1/30    781   P2P   0/0
	Et0/0        1     0               192.168.1.1/24     10    WAIT  0/0


	Вопросы для повторения
1.	Почему так важно управлять назначением идентификатора маршрутизатора при использовании протокола OSPF?

- Контролировать выбор DR и BDR

- Лучше понимать таблицу маршрутизации

- Не перестраивать полностью ospf, если с маршрутизатора будет удален или изменен интерфейс конторый был выбран индентификатором.

2.	Почему в этой лабораторной работе не рассматривается процесс выбора DR/BDR?

Для 3 роутеров не будет экономии в количестве передаваемых данных, чтобы использовать DR и BDR

3.	Почему рекомендуется настраивать интерфейс OSPF как пассивный?

- Для безопасности, чтобы не отправлять и получать обновления с интерфейсов не добавленных в схему ospf(например пользовательские)

- Не создвать лишний трафик


